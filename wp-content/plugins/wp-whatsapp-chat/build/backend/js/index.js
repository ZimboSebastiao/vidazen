!function(){"use strict";var e={n:function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,{a:a}),a},d:function(t,a){for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.jQuery,a=e.n(t);window.wp.wpColorPicker,window.jQuery.select2,function(e){function t(t){t?e("#submit").attr("disabled",!0):e("#submit").attr("disabled",!1)}t(!0),e("form").change((function(e){t(!1)})),e(".button").click((function(){t(!1)})),e("button").click((function(){t(!1)})),e(".qlwapp-color-field").wpColorPicker({change:function(e,a){t(!1)},clear:function(e,a){t(!1)}}),e(document).on("tinymce_change",(function(e){t(!1)})),e(document).on("qlwapp-enhanced-select",(function(t){e(".qlwapp-select2").filter(":not(.enhanced)").each((function(){e(this).select2({allowClear:!1,theme:"default",minimumResultsForSearch:-1}).addClass("enhanced")})),e(".qlwapp-select2-search").filter(":not(.enhanced)").each((function(){var t=e(this),a=e(this).data("name"),n={allowClear:!0,ajax:{url:ajaxurl,dataType:"json",data:function(e){return{name:a,per_page:10,q:e.term||0,selected:t.select2("val")||0,action:"qlwapp_get_posts",nonce:qlwapp.nonce.qlwapp_get_posts}},processResults:function(t){var a=[];return t&&e.each(t,(function(e,t){a.push({id:e,text:t})})),{results:a}},cache:!0},minimumInputLength:3};e(this).select2(n).addClass("enhanced")}))})).trigger("qlwapp-enhanced-select"),e("select[name=box]").on("change",(()=>{e(".nav-tab.qlwapp_box").toggleClass("hidden"),e("select[name=type]").toggleClass("disabled"),e("input[name=group]").toggleClass("disabled"),e("input[name=phone]").toggleClass("disabled"),e(".qlwapp-phone-alert").toggleClass("hidden"),e(".nav-tab.qlwapp_contacts").toggleClass("hidden");var t=e("#qlwapp_button_form"),a=t.find("#qlwapp_button_form_nonce").val();t.trigger("qlwapp.save",["qlwapp_save_button",a])})),e("select[name=googleAnalytics]").on("change",(t=>{const a=e("select[name=googleAnalytics]").val();"disable"==a?(e(".qlwapp-phone-alert").addClass("hidden"),e(".googleEventContainer").addClass("hidden")):(e(".qlwapp-phone-alert").removeClass("hidden"),e(".googleEventContainer").removeClass("hidden")),"v3"==a?e(".googlev3container").removeClass("hidden"):e(".googlev3container").addClass("hidden"),"v4"==a?e(".googlev4container").removeClass("hidden"):e(".googlev4container").addClass("hidden")})),"no"==e("select[name=auto_open]").val()&&e("input[name=auto_delay_open]").closest("tr").addClass("hidden"),e("select[name=auto_open]").on("change",(()=>{e("input[name=auto_delay_open]").closest("tr").toggleClass("hidden")})),e("select[name=type]").on("change",(()=>{e("input[name=phone]").closest("tr").toggleClass("hidden"),e("input[name=group]").closest("tr").toggleClass("hidden"),e("textarea[name=message]").toggleClass("disabled")})),e(".qlwapp-color-field").wpColorPicker(),e(document).on("click",".upload_image_button",(function(t){t.preventDefault();var a=wp.media.editor.send.attachment,n=e(this);return wp.media.editor.send.attachment=function(t,i){e(n).parent().prev().attr("src",i.url),e(n).prev().val(i.url).trigger("change"),wp.media.editor.send.attachment=a},wp.media.editor.open(n),!1})),e(document).on("click",".remove_image_button",(function(t){t.preventDefault();var a=e(this).parent().prev().attr("data-src");return e(this).parent().prev().attr("src",a),e(this).prev().prev().val("").trigger("change"),!1})),e(document).on("qlwapp.save","form",(function(a,n,i){var o=e(a.currentTarget),s=o.find(".settings-save-status .spinner"),l=o.find(".settings-save-status .saved");return e.ajax({url:ajaxurl,data:{action:n,nonce:i,form_data:o.serialize()},dataType:"json",type:"POST",beforeSend:function(){t(!0),s.addClass("is-active")},complete:function(){s.removeClass("is-active")},error:function(e){console.log(e)},success:function(e){l.addClass("is-active"),e.success?setTimeout((function(){l.removeClass("is-active")}),2e3):alert(e.data)}}),!1})),e(document).on("submit","#qlwapp_button_form",(function(t){t.preventDefault();var a=e(this),n=a.find("#qlwapp_button_form_nonce").val();a.trigger("qlwapp.save",["qlwapp_save_button",n])})),e(document).on("submit","#qlwapp_woocommerce_form",(function(t){t.preventDefault();var a=e(this),n=a.find("#qlwapp_woocommerce_form_nonce").val();a.trigger("qlwapp.save",["qlwapp_save_woocommerce",n])})),e(document).on("submit","#qlwapp_box_form",(function(t){t.preventDefault();var a=e(this),n=a.find("#qlwapp_box_form_nonce").val();a.trigger("qlwapp.save",["qlwapp_save_box",n])})),e(document).on("submit","#qlwapp_display_form",(function(t){t.preventDefault();var a=e(this),n=a.find("#qlwapp_display_form_nonce").val();a.trigger("qlwapp.save",["qlwapp_save_display",n])})),e(document).on("submit","#qlwapp_scheme_form",(function(t){t.preventDefault();var a=e(this),n=a.find("#qlwapp_scheme_form_nonce").val();a.trigger("qlwapp.save",["qlwapp_save_scheme",n])})),e(document).on("submit","#qlwapp_settings_form",(function(t){t.preventDefault();var a=e(this),n=a.find("#qlwapp_settings_form_nonce").val();a.trigger("qlwapp.save",["qlwapp_save_settings",n])}))}(a()),window.wp.util,window.window.sortable,window.window.Backbone,function(e){var t,a=0;if(window.qlwapp_contact){var n=function(){e("#qlwapp_modal").removeClass("processing")};_.mixin({escapeHtml:function(e){return e.replace("&amp;",/&/g).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#039;/g,"'")}});var i=Backbone.Model.extend({defaults:qlwapp_contact.args}),o=Backbone.View.extend({templates:{},initialize:function(e){this.templates.window=wp.template(e.subview)},render:function(){var e=this;return e.$el.html(e.templates.window(e.attributes)),this}}),s=Backbone.View.extend({templates:{},initialize:function(e){this.templates.window=wp.template(e.subview)},render:function(){var e=this;return e.$el.html(e.templates.window(e.attributes)),this}}),l=Backbone.View.extend({templates:{},initialize:function(e){this.templates.window=wp.template(e.subview)},render:function(){var e=this;return e.$el.html(e.templates.window(e.attributes)),this}}),r=Backbone.View.extend({templates:{},initialize:function(e){this.templates.window=wp.template(e.subview)},render:function(){var e=this;return e.$el.html(e.templates.window(e.attributes)),this}}),c=(Backbone.View.extend({templates:{},initialize:function(e){this.templates.window=wp.template(e.subview)},render:function(){var e=this;return e.$el.html(e.templates.window(e.attributes)),this}}),Backbone.View.extend({templates:{},initialize:function(e){this.templates.window=wp.template(e.subview)},render:function(){var e=this;return e.$el.html(e.templates.window(e.attributes)),this}})),d=Backbone.View.extend({templates:{},initialize:function(e){this.templates.window=wp.template(e.subview)},render:function(){var e=this;return e.$el.html(e.templates.window(e.attributes)),this}}),p=(Backbone.View.extend({templates:{},initialize:function(e){this.templates.window=wp.template(e.subview)},render:function(){var e=this;return e.$el.html(e.templates.window(e.attributes)),this}}),Backbone.View.extend({events:{"change input":"enable","change textarea":"enable","change select":"enable","click .media-modal-backdrop":"close","click .media-modal-close":"close","click .media-modal-prev":"edit","click .media-modal-next":"edit","change .media-select-change":"change","change .media-modal-change":"change","change .media-modal-subview2":"subview2","submit .media-modal-form":"submit"},templates:{},initialize:function(){_.bindAll(this,"open","edit","change","subview2","load","render","close","submit"),this.init(),this.open()},init:function(){this.templates.window=wp.template("qlwapp-modal-window")},LoadTemplate1:function(e){var t=Backbone.View.extend({templates:{},initialize:function(e){this.templates.window=wp.template(e.subview)},render:function(){var e=this;return e.$el.html(e.templates.window(e.attributes)),this}});return t},assign:function(e,t){e.setElement(this.$(t)).render()},render:function(){var e=this,t=this.$el.find("ul.wc-tabs li.active a").attr("href");e.$el.html(e.templates.window(e.model.attributes)),this.header=new o({subview:"subview-header",attributes:e.model.attributes}),this.footer=new s({subview:"subview-footer",attributes:e.model.attributes}),this.tabs=new l({subview:"subview-tabs",attributes:e.model.attributes}),this.contact=new r({subview:"subview-contact",attributes:e.model.attributes}),this.info=new d({subview:"subview-contact-info",attributes:e.model.attributes}),this.visibility=new c({subview:"subview-visibility",attributes:e.model.attributes}),this.assign(this.header,"#panel-header"),this.assign(this.footer,"#panel-footer"),this.assign(this.tabs,"#panel-tabs"),this.assign(this.contact,"#panel-contact"),this.assign(this.info,"#panel-info"),this.assign(this.visibility,"#panel-visibility"),_.delay((function(){e.$el.trigger("qlwapp-enhanced-select"),e.$el.trigger("qlwapp-tab-panels",t)}),100)},load:function(){var t=this;e("#qlwapp_modal").addClass("processing"),e.ajax({url:ajaxurl,data:{action:"qlwapp_edit_contact",nonce:qlwapp_contact.nonce.qlwapp_edit_contact,contact_id:this.model.attributes.id},dataType:"json",type:"POST",beforeSend:function(){},complete:function(){n()},error:function(){alert("Error!")},success:function(e){e.success?(t.model.set(e.data),t.render()):alert(e.data)}})},edit:function(n){n.preventDefault();var i=this,o=e(n.target),s=parseInt(e("#qlwapp_contacts_table tr[data-contact_id]").length),l=parseInt(i.model.get("order"));a++,t&&clearTimeout(t),t=setTimeout((function(){l=o.hasClass("media-modal-next")?Math.min(l+a,s):Math.max(l-a,1),i.model.set({id:parseInt(e("#qlwapp_contacts_table tr[data-contact_position="+l+"]").data("contact_id"))}),a=0,i.load()}),300)},open:function(t){e("body").addClass("modal-open").append(this.$el),null!=this.model.attributes.id?this.load():_.delay((function(){n()}),100)},update:function(t){t.preventDefault();var a=e(t.target),n=a.attr("name"),i=a.val();"checkbox"===t.target.type&&(i=!0===a.prop("checked")?1:0),this.model.attributes[n]=i,this.model.changed[n]=i},change:function(e){e.preventDefault(),this.update(e)},subview2:function(e){this.contact.render()},reload:function(e){this.$el.find("#qlwapp_modal").hasClass("reload")?location.reload():this.remove()},close:function(t){t.preventDefault(),this.undelegateEvents(),e(document).off("focusin"),this.$el.find("#qlwapp_modal").addClass("reload"),this.reload(t)},enable:function(t){e(".media-modal-submit").prop("disabled",!1)},submit:function(t){t.preventDefault();var a=this,n=a.$el.find("#qlwapp_modal"),i=n.find(".attachment-details");return console.log(e("form",this.$el).serializeArray()),e.ajax({url:ajaxurl,data:{action:"qlwapp_save_contact",nonce:qlwapp_contact.nonce.qlwapp_save_contact,contact_id:a.model.attributes.id,contact_data:e("form",this.$el).serialize()},dataType:"json",type:"POST",beforeSend:function(){e(".media-modal-submit").prop("disabled",!0),i.addClass("save-waiting")},complete:function(){i.addClass("save-complete"),i.removeClass("save-waiting")},error:function(){alert("Error!")},success:function(e){e.success?null==a.model.attributes.id&&(n.addClass("reload"),a.reload(t),a.close(t)):alert(e.data)}}),!1}})),u=Backbone.View.extend({initialize:function(t){var a=e(t.target).closest("[data-contact_id]").data("contact_id"),n=new i;n.set({id:a}),new p({model:n}).render()}}),m=!1;e(".qlwapp_settings_edit").on("click",(function(e){e.preventDefault(),m||(new u(e),m=!0)})),e("#qlwapp_contact_add").on("click",(function(e){e.preventDefault(),new u(e)})),e(".qlwapp_settings_delete").on("click",(function(t){t.preventDefault();var a=e("#qlwapp_delete_contact_nonce").val(),n=e(t.target).closest("[data-contact_id]").data("contact_id");if(!confirm(qlwapp_contact.message.contact_confirm_delete))return!1;e.ajax({url:ajaxurl,data:{action:"qlwapp_delete_contact",nonce:a,contact_id:n},dataType:"json",type:"POST",beforeSend:function(){},complete:function(){},error:function(e){console.log(e)},success:function(e){e.data?location.reload():alert(e.data)}})})),e("table#qlwapp_contacts_table tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,helper:function(t,a){return a.children().each((function(){e(this).width(e(this).width())})),a.css("left","0"),a},start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style"),t.item.trigger("updateMoveButtons"),t.item.trigger("updateSaveButton")}}),e(document).on("updateSaveButton",(function(){e("#qlwapp_contact_order").prop("disabled",!1)})),e(".wc-item-reorder-nav").find(".wc-move-up, .wc-move-down").on("click",(function(){var t=e(this),a=t.closest("tr");t.focus();var n=t.is(".wc-move-up"),i=t.is(".wc-move-down");if(n){var o=a.prev("tr");o&&o.length&&o.before(a)}else if(i){var s=a.next("tr");s&&s.length&&s.after(a)}t.focus(),t.closest("table").trigger("updateMoveButtons"),t.closest("table").trigger("updateSaveButton")})),e(".wc-item-reorder-nav").closest("table").on("updateMoveButtons",(function(){var t=e(this),a=e(this).find("tbody tr:last"),n=e(this).find("tbody tr:first");t.find(".wc-item-reorder-nav .wc-move-disabled").removeClass("wc-move-disabled").attr({tabindex:"0","aria-hidden":"false"}),n.find(".wc-item-reorder-nav .wc-move-up").addClass("wc-move-disabled").attr({tabindex:"-1","aria-hidden":"true"}),a.find(".wc-item-reorder-nav .wc-move-down").addClass("wc-move-disabled").attr({tabindex:"-1","aria-hidden":"true"})})),e("table#qlwapp_contacts_table tbody").trigger("updateMoveButtons"),e(document).on("submit","#qlwapp_contacts_form",(function(t){t.preventDefault();var a=e(this),n=a.find(".settings-save-status .spinner"),i=a.find(".settings-save-status .saved");return e.ajax({url:ajaxurl,data:{action:"qlwapp_save_contact_order",nonce:qlwapp_contact.nonce.qlwapp_save_contact_order,contact_data:a.serialize()},dataType:"json",type:"POST",beforeSend:function(){n.addClass("is-active")},complete:function(){n.removeClass("is-active")},error:function(e){console.log(e)},success:function(t){i.addClass("is-active"),e("#qlwapp_contact_order").prop("disabled",!0),t.success?setTimeout((function(){i.removeClass("is-active")}),1500):alert(t.data)}}),!1})),e(document).on("qlwapp-tab-panels",(function(t,a){var n=e(t.target).find("ul.qlwapp-tabs"),i=n.find('a[href="'+a+'"]');n.show(),n.find("a").click((function(t){t.preventDefault();var a=e(this).closest("div.panel-wrap");n.find("li",a).removeClass("active"),e(this).parent().addClass("active"),e("div.panel",a).hide(),e(e(this).attr("href")).show()})),i.length&&e(i.attr("href")).length?i.click():n.find("li.active").find("a").click()}))}}(a())}();